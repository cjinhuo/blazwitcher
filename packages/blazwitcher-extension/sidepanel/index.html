<!doctype html>
<html lang="en">

  <head>
    <meta charset="UTF-8" />
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="Content-Security-Policy"
          content="script-src 'self' 'unsafe-inline' http://localhost;" />
    <title>Blazwitcher v0.6.0</title>
  </head>

  <body>
    <script>
      // 动态设置 HTML lang 属性
      (function () {
        const PAGE_STORAGE_LANGUAGE_KEY = 'language';
        // 获取默认语言（基于浏览器语言）
        const getDefaultLanguage = () => {
          return navigator.language.toLowerCase().startsWith('zh') ? 'zh' : 'en';
        };
        // 从 localStorage 获取用户设置的语言，如果没有则使用默认语言
        const getUserLanguage = () => {
          try {
            const storedLang = localStorage.getItem(PAGE_STORAGE_LANGUAGE_KEY);
            if (storedLang) {
              return parsedLang === 'zh' ? 'zh' : 'en';
            }
          } catch (e) {
            console.warn('Failed to parse stored language:', e);
            return getDefaultLanguage();
          }
          return getDefaultLanguage();
        };

        // 设置 HTML lang 属性
        const setHtmlLang = () => {
          const language = getUserLanguage();
          const langCode = language === 'zh' ? 'zh-CN' : 'en';
          document.documentElement.setAttribute('lang', langCode);
        };

        // 立即设置语言
        setHtmlLang();
      })();
    </script>
  </body>

</html>